# Cyb07-onl

## 5. Сети, маршрутизация. Часть 2

### Дата и время занятия
Вторник, 23 Сентябрь, 19:00-22:00

### Описание занятия
Модель OSI
TCP, UDP и сказ о том, почему всё строится именно на них
BGP и NAT
IPv4 и IPv6, почему сеть до сих пор работает на устаревшем протоколе?
Практика/квиз по октетам IPv4 и сокращениям IPv6

### Домашние задания
Домашнее задание
 1. Скопировать из презентации модель OSI, дополнить каждый уровень примерами (оборудование, передача данных, приложение) и по одной атаке на каждый уровень.

    Семь уровней модели OSI (Физический Канал Сети Транспортирует Сессии Представляя Приложения):
    Physical Layer (Физический уровень)
        Назначение:
            отвечает за передачу сырых битов по физической среде (кабель, радиоволны и т.д.). Определяет электрические, механические, процедурные и функциональные характеристики соединения.
        Примеры реализации: 
            аппартная реализация Ethernet, USB, Bluetooth, Wifi, кабели, концентраторы (хабы).
        Примеры атак:
            Поскольку уровень связан с физическими носителями и оборудованием, атаки на нём носят не программную, а физическую или электромагнитную природу и позволяют полностью нарушить связь или перехватить данные на самом низком уровне.
            1. Отключение кабеля / Обрыв линии связи (Cable Cutting)
                Физическое повреждение или отключение сетевого кабеля для нарушения связи, Dos
                Защита: Физическая охрана, резервирование каналов связи, использование беспроводных резервных каналов.
            2. Помехи и подавление сигнала (Jamming)
                Намеренное создание радиопомех в беспроводных сетях (Wi-Fi, Bluetooth, сотовая связь) с целью нарушения связи, DoS.
                Защита: Использование защищённых частот, переключение каналов, обнаружение джеммеров.
            3. Перехват данных (Tapping / Wiretapping)
                Злоумышленник физически подключается к кабелю (медному или оптоволоконному), чтобы перехватывать передаваемые данные.
                Защита: Использование экранированных кабелей, оптоволокна, регулярный осмотр инфраструктуры, шифрование на более высоких уровнях (например, TLS, IPsec).
            4. Электромагнитный перехват данных (TEMPEST-атаки)
                Перехват данных по побочному электромагнитному излучению от кабелей, мониторов или устройтв. Не требует прямого подключения — достаточно находиться рядом с оборудованием.
                Защита: Экранирование помещений (фарадеевская клетка), использование оборудования с низким уровнем излучения.
            5. Подмена оборудования (Hardware Tampering)
                Установка злоумышленного оборудования в сеть — например, поддельного хаба, сплиттера или "жучка" для перехвата, модификация или блокировка трафика.
                Защита: Контроль доступа к серверным и сетевым шкафам, инвентаризация оборудования.
            
            Современные технологии защиты на физическом уровне:
                MACsec (IEEE 802.1AE) — стандарт шифрования трафика на канальном/физическом уровне для Ethernet.
                Оптические датчики — обнаруживают попытки перехвата в оптоволокне.
                Системы мониторинга целостности кабелей.

            Важно:
                Физический уровень не обеспечивает никакой логической защиты — он просто передаёт биты. Поэтому безопасность на этом уровне достигается за счёт физических мер (охрана, замки, экранирование) и шифрования на более высоких уровнях (например, на транспортном или прикладном).

    Data Link Layer (Канальный уровень)
        Назначение:
            обеспечивает надёжную передачу данных между двумя узлами в пределах одной сети. Осуществляет обнаружение и (иногда) исправление ошибок, управление доступом к среде (MAC-адреса).
        Примеры реализации: 
            программная реализация Ethernet, PPP, WiFi (IEEE 802.11), коммутаторы (switches).
        Примеры атак:
            Поскольку на этом уровне данные передаются в виде кадров (frames), а идентификация устройств происходит по физическим (MAC) адресам, атаки на канальном уровне связаны с подменой адресов, перехватом трафика или нарушением работы коммутаторов.           
            1. ARP-спуфинг (ARP Spoofing / ARP Poisoning)
                Злоумышленник отправляет ложные ARP-сообщения в локальную сеть, чтобы связать свой MAC-адрес с IP-адресом другого устройства (например, шлюза или жертвы) для осуществления перехвата, модификации или блокировки трафика между двумя узлами (атака MITM - "человек посередине"). При этои жертва думает, что отправляет данные шлюзу, но на самом деле отправляет их атакующему.
                Защита: Статические ARP-записи (редко используется), Протоколы типа DHCP Snooping + Dynamic ARP Inspection (DAI) на коммутаторах, Использование шифрования (HTTPS, TLS), чтобы даже при перехвате данные оставались защищёнными.
            2. MAC-флудинг (MAC Flooding)
                Атакующий отправляет огромное количество кадров с поддельными MAC-адресами на коммутатор с целью переполнить таблицу MAC-адресов (CAM-таблицу) коммутатора. Коммутатор перестаёт "понимать" , куда отправлять кадры, и начинает работать как хаб — рассылает весь трафик на все порты, что позволяет выполнить перехват трафика.
                Защита: Port Security — ограничение количества MAC-адресов на порту, Блокировка неизвестных MAC-адресов, Использование управляемых коммутаторов с защитными функциями.
            3. Атака через VLAN Hopping
                Попытка обойти изоляцию между VLAN (виртуальными локальными сетями) и получить доступ к трафику другой VLAN.
                Switch spoofing: Атакующий имитирует работу коммутатора и использует протоколы вроде DTP (Dynamic Trunking Protocol), чтобы установить trunk-соединение и получить доступ ко всем VLAN.
                Double tagging: Отправка кадра с двумя VLAN-тегами (IEEE 802.1Q), чтобы обмануть коммутатор.
                Защита: Отключить DTP на портах пользователей (switchport nonegotiate), Не использовать VLAN 1 для пользовательского трафика, явное назначать порты как access/trunk, добавить фильтрацию тегированных кадров на access-портах.
            4. STP-спуфинг (Spanning Tree Protocol Spoofing)
                Атакующий отправляет поддельные BPDU-пакеты (Bridge Protocol Data Units), чтобы заставить коммутаторы перестроить топологию сети, самому стать корневым мостом (root bridge) и перенаправить через себя весь трафик.
                Защита: BPDU Guard — автоматически отключает порт при получении BPDU, Root Guard — предотвращает смену корневого моста на защищённых портах, Отключение STP на портах, где он не нужен.
            5. DHCP-спуфинг (Rogue DHCP Server)
                Хотя DHCP формально работает на прикладном уровне, его влияние проявляется на канальном уровне, так как клиент получает неправильные сетевые настройки (шлюз, DNS) от поддельного сервера и в результате трафик направляется злоумышленнику.
                Защита: DHCP Snooping на коммутаторах — разрешает DHCP-ответы только с доверенных портов.
            
            Общие принципы защиты на канальном уровне:
                Использование управляемых коммутаторов с функциями безопасности.
                Включение механизмов Port Security, DHCP Snooping, Dynamic ARP Inspection (DAI), BPDU Guard.
                Сегментация сети с помощью VLAN (с правильной настройкой).
                Физическая защита сетевого оборудования.
                Шифрование трафика на более высоких уровнях (TLS, IPsec) — даже если трафик перехвачен, данные останутся защищёнными.
            
            Важно:
                Канальный уровень не проверяет подлинность устройств по умолчанию — MAC-адреса легко подделать. Поэтому безопасность на этом уровне должна обеспечиваться активными мерами на сетевом оборудовании.

    Network Layer (Сетевой уровень)
        Назначение:
            отвечает за маршрутизацию данных между разными сетями. Определяет логические адреса (например, IP-адреса) и выбирает оптимальный путь доставки пакетов.
        Примеры реализации:
            протоколы IP (IPv4, IPv6), ICMP, маршрутизаторы (routers).
        Примеры атак:
            Атаки на сетевом уровне направлены на нарушение маршрутизации, подделку адресов, перехват или подавление трафика, а также на исчерпание ресурсов сетевых устройств.
            1. IP-спуфинг (IP Spoofing)
                Подделка источника IP-адреса в заголовке IP-пакета, что бы скрыть реальный источник атаки, обойти ACL (списки контроля доступа) основанные на IP. Используется в связке с другими атаками (например, DDoS).
                ! При двухсторонней связи (TCP) спуфинг затруднён, так как ответ придёт на поддельный адрес. Но эффективен в односторонних атаках (например, UDP-флуд).
                Защита: Фильтрация на границе сети (BCP38 — ingress/egress filtering), Использование протоколов с аутентификацией (IPsec), Мониторинг аномального трафика.
            2. Атака типа "Отказ в обслуживании" (DoS/DDoS) на сетевом уровне
                Нацелена на перегрузку канала связи жертвы или сетевого оборудования, реализуется как
                    SYN-flood (частично транспортный уровень, но использует IP).
                    UDP-flood, ICMP-flood (Ping flood) — отправка большого объёма UDP/ICMP-пакетов на цель.
                    Amplification-атаки (например, через DNS, NTP, Memcached): отправка запросов с поддельным IP-адресом жертвы → сервер отвечает большим объёмом данных.
                Защита: Rate limiting (ограничение скорости трафика), Фильтрация на пограничных маршрутизаторах, Использование CDN и DDoS-защиты (Cloudflare, AWS Shield и др.).
            3. Атаки с использованием ICMP
                a) Smurf-атака: Отправка ICMP Echo Request (ping) на широковещательный адрес с поддельным IP-адресом жертвы. Все устройства в сети отвечают жертве → её сеть перегружается. Но современные сети блокируют широковещательные ICMP-запросы, поэтому атака устарела.
                b) Ping of Death: Отправка фрагментированных ICMP-пакетов, которые при сборке превышают максимальный размер (65 535 байт).Может вызвать сбой в старых ОС из-за переполнения буфера, но проблема исправлена в современных системах.
                Защита: Отключение ненужных ICMP-сообщений, фильтрация на маршрутизаторах, обновление ПО.
            4. Атаки на маршрутизацию
                a) Подделка маршрутов (Route Injection / BGP Hijacking): Злоумышленник объявляет ложные маршруты (например, через BGP), чтобы перенаправить трафик через свой узел для перехвата, анализа или блокировки трафика (например, между странами или провайдерами).
                Защита: BGPsec, RPKI (Resource Public Key Infrastructure), мониторинг маршрутов.
                b) Атаки на протоколы внутренней маршрутизации (RIP, OSPF): Подделка обновлений маршрутизации → изменение топологии сети.
                Защита: Аутентификация в OSPF (MD5/SHA), отключение RIP в пользу более безопасных протоколов.
            5. Фрагментация и атаки на сборку пакетов
                Teardrop-атака: Отправка перекрывающихся фрагментов IP-пакетов с некорректными смещениями, при этом старые ОС не могли корректно собрать такие пакеты → сбой ядра ОС. 
                Защита: Корректная реализация обработки фрагментов, фильтрация подозрительных пакетов.
            6. Source Routing Attacks (в IPv4)
                Использование опции IP Source Routing, чтобы указать путь пакета через сеть для обхода фаерволов, перехвата трафика. Но на текущий момент опция отключена по умолчанию почти везде.
                Защита: Блокировка пакетов с опциями source routing на границе сети.

            Общие меры защиты на сетевом уровне:
                Фильтрация трафика (на маршрутизаторах и фаерволах).
                Отключение ненужных протоколов и опций (ICMP redirect, source routing).
                Использование IPsec для аутентификации и шифрования IP-трафика.
                Мониторинг и анализ трафика (IDS/IPS, NetFlow).
                Обновление прошивок и ОС для устранения уязвимостей в обработке IP-пакетов.
                Сегментация сети и ограничение межсетевого взаимодействия.
            Важно:
                Хотя многие атаки на сетевом уровне устарели благодаря улучшению безопасности ОС и оборудования, они по-прежнему актуальны в Устаревших системах (промышленные контроллеры, IoT), Крупных сетях (BGP-хищничество) и DDoS-кампаниях (амплификация через UDP-сервисы).


    Transport Layer (Транспортный уровень)
        Назначение:
            Обеспечивает надёжную передачу данных между конечными точками (хостами). Управляет сегментацией, сборкой, контролем ошибок, потоком и повторной передачей.
        Примеры реализации:
            протоколы TCP (надёжный, с установлением соединения), UDP (быстрый, без установления соединения).
        Примеры атак:
            Атаки на транспортном уровне направлены на нарушение соединения, исчерпание ресурсов, перехват сессий или подделку транспортных сегментов.
            1. SYN-flood (атака типа DoS/DDoS)
                Злоумышленник отправляет множество TCP-пакетов с флагом SYN, но не завершает трёхэтапное рукопожатие (не отправляет ACK), что бы заполнить очередь полусоединений (SYN queue) на сервере → новые легитимные подключения не смогут быть установлены → Отказ в обслуживании (DoS).
                Защита: SYN cookies — механизм, позволяющий не хранить состояние полусоединения. Ограничение количества соединений с одного IP. Использование фаерволов и систем защиты от DDoS.
            2. TCP Reset-атака (TCP RST Injection)
                Атакующий отправляет поддельный TCP-пакет с флагом RST (Reset), чтобы принудительно разорвать установленное соединение (перед этим нужно угадать или перехватить номера последовательности (sequence number) и порты) и нарушить связь между двумя узлами (например, разорвать SSH- или HTTPS-сессию). Риски для данной атаки высоки в незашифрованных сетях (Wi-Fi) или при слабой генерации sequence numbers.
                Защита: Использование шифрования (TLS/SSL) — даже если соединение разорвано, данные не будут скомпрометированы. Современные ОС используют случайные и трудноугадываемые sequence numbers.
            3. TCP Session Hijacking (угон сессии)
                Атакующий перехватывает активное TCP-соединение и начинает отправлять пакеты от имени одной из сторон (для этого необходим доступ к трафику, например через ARP-спуфинг в локальной сети, знание текущих sequence/acknowledgment numbers) что бы выполнить действия от имени жертвы (например, отправить команды по уже авторизованному SSH-соединению).
                Защита: Шифрование (SSH, TLS). Использование безопасных сетей (избегать публичных Wi-Fi без VPN). Механизмы обнаружения аномалий.
            4. UDP-flood
                Массовая отправка UDP-пакетов на случайные порты цели (т.к. UDP — без установления соединения, легко подделать источник) → сервер генерирует ICMP-сообщения "Port Unreachable", что нагружает CPU и сеть. Часто используется в амплификационных DDoS-атаках (например, через DNS, NTP, SSDP).
                Защита: Rate limiting. Фильтрация на пограничных маршрутизаторах. Отключение ненужных UDP-сервисов.
            5. Атаки на порты (Port Scanning и связанные угрозы)
                Хотя сканирование портов — это разведка, а не прямая атака, оно происходит на транспортном уровне: 
                SYN scan — отправка SYN-пакетов для определения открытых портов.
                FIN/XMAS/NULL scans — использование нестандартных флагов для обхода фаерволов.
                Защита: IDS/IPS (например, Snort, Suricata). Настройка фаерволов (блокировка ненужных портов). Регулярное обновление ПО.
            6. Атака "Land" (Local Area Network Denial)
                Отправка TCP-пакета, в котором IP-адрес источника и назначения одинаковы, а также порт источника = порту назначения. В уязвимых системах (старые Windows, Cisco IOS) это вызывало зацикливание или сбой.
                Защита: Фильтрация пакетов с одинаковыми IP источника и назначения на границе сети.
            
            Общие меры защиты на транспортном уровне:
                Использование фаерволов для фильтрации трафика по портам и протоколам.
                Включение механизмов защиты от перегрузки (SYN cookies, rate limiting).
                Шифрование сессий (TLS, SSH) — даже при перехвате или угоне данные остаются защищёнными.
                Мониторинг сетевой активности на предмет аномалий (IDS/IPS).
                Обновление ОС и сетевого оборудования для устранения уязвимостей в реализации TCP/IP.
            Важно:
                TCP обеспечивает надёжность, но уязвим к атакам, связанным с состоянием соединения.
                UDP быстр, но не имеет встроенной защиты — легко используется в DDoS.
                Ни TCP, ни UDP не обеспечивают шифрования или аутентификации — это задача более высоких уровней (например, TLS на прикладном уровне).    

    Session Layer (Сеансовый уровень)
        Назначение:
            Управляет установлением, поддержанием и завершением сеансов связи между приложениями. Обеспечивает синхронизацию и восстановление сеанса при сбое.
        Примеры реализации:
            протоколы NetBIOS, RPC (gRPC), PPTP.
        Примеры атак:
            В реальных сетях чистых протоколов сеансового уровня почти нет — его функции часто интегрированы в прикладные протоколы (например, RPC, SIP, NetBIOS, PPTP) или реализованы внутри приложений (веб-сессии через cookies). Тем не менее, атаки, направленные на нарушение, перехват или подделку сессий, часто относят к этому уровню — особенно когда речь идёт о управлении состоянием сеанса.
            Пример из жизни:
                Пользователь заходит в интернет-банк по Wi-Fi в кафе. Злоумышленник в той же сети перехватывает его session cookie через ARP-спуфинг. Через 5 минут атакующий заходит в банковский аккаунт от имени жертвы — без пароля, без 2FA (если не привязан к устройству). 

            1. Угон сессии (Session Hijacking)
                Злоумышленник перехватывает или подделывает идентификатор сессии (например, session ID, токен), чтобы получить доступ к активной сессии пользователя. Используется в Веб-приложения (через cookies), VoIP (SIP).
                Методы:
                    Перехват трафика (например, через ARP-спуфинг в LAN).
                    XSS (межсайтовый скриптинг) — кража cookie через JavaScript.
                    Предсказание или подбор session ID (если он слабо генерируется).
                В результате атакующий получает полную авторизацию жертвы без знания пароля.
                Защита: Использование HTTPS (TLS) — шифрует cookie и session ID. Установка флага HttpOnly и Secure для cookies. Генерация длинных, случайных, непредсказуемых идентификаторов сессий. Привязка сессии к IP или User-Agent (с осторожностью — может нарушать UX).
            2. Атака на восстановление сессии (Session Replay / Fixation)
                a) Session Fixation: Атакующий заставляет жертву использовать известный ему session ID (например, через ссылку с ?sessionid=123). После входа жертвы в систему атакующий использует этот же ID для доступа к аккаунту.
                Защита: Генерировать новый session ID после успешной аутентификации.
                b) Session Replay: Перехват и повторная отправка (replay) легитимных сессионных сообщений. Особенно опасен в системах без временных меток или nonce.
                Защита: Использование nonce, временных меток, одноразовых токенов.
            3. Атаки на протоколы сеансового уровня
                Некоторые специализированные протоколы работают на этом уровне и имеют свои уязвимости:
                a) NetBIOS / SMB (частично): Устаревшие реализации позволяли перехватывать сессии в Windows-сетях, например атака SMB Relay — перенаправление аутентификационных данных на другой сервер.
                Защита: Отключение NetBIOS/SMBv1, использование SMB signing.
                b) RPC (Remote Procedure Call): Уязвимости в реализации могут позволить подмену сессии или выполнение кода, например уязвимости в MS-RPC (использовались в червях типа Blaster).
                с) PPTP (Point-to-Point Tunneling Protocol): Несмотря на то, что это протокол туннелирования, он управляет сессиями и Известен слабым шифрованием и уязвимостями в установке сессии, плэтому лучше использовать современную замену: IPsec, OpenVPN, WireGuard.
            4. Принудительное завершение сессии (Session Termination Attack)
                Атакующий отправляет поддельное сообщение о завершении сессии (например, в SIP или RPC) что бы разорвать связь между пользователями (например, в VoIP-звонке).
                Защита: Аутентификация управляющих сообщений, шифрование.

            Общие меры защиты:
                Шифрование всего сессионного трафика (TLS/SSL).
                Безопасная генерация и хранение идентификаторов сессий.
                Автоматическое завершение неактивных сессий.
                Многофакторная аутентификация (MFA) — даже при угоне сессии доступ может быть ограничен.
                Мониторинг аномалий (вход с нового устройства/IP во время активной сессии).
            Важно:
                В модели TCP/IP сеансовый уровень не выделен явно — его функции выполняются прикладными протоколами. Поэтому большинство "атак сеансового уровня" на практике реализуются как атаки на прикладной уровень, но логически относятся к управлению сессией. Главная цель таких атак — обход аутентификации путём захвата уже установленной доверенной сессии.

    Presentation Layer (Уровень представления)
        Назначение:
            Отвечает за формат данных, шифрование, сжатие и преобразование данных для прикладного уровня. Обеспечивает совместимость между разными системами (например, ASCII ↔ EBCDIC).
        Примеры реализации:
            протоколы SSL/TLS (частично), JPEG, MPEG, MIME.
        Примеры атак:
            Хотя чистых протоколов уровня представления почти не существует (его функции обычно интегрированы в прикладные протоколы или библиотеки), атаки, связанные с некорректной обработкой форматов данных, шифрования или сжатия, логически относятся к этому уровню.
            Пример из практики:
                Веб-сервер принимает изображение от пользователя, обрабатывает его через уязвимую версию ImageMagick (баг ImageTragick). Злоумышленник загружает специально созданный SVG-файл, который при обработке выполняет произвольную команду на сервере. Это атака на уровень представления, так как проблема возникает при преобразовании формата данных. 
            
            1. Атаки на реализацию шифрования (Cryptographic Attacks)
                Хотя шифрование часто ассоциируется с прикладным уровнем (например, TLS), сам процесс шифрования/дешифрования — функция уровня представления. Суть атак - эксплуатация ошибок в реализации криптографических алгоритмов или некорректного использования шифров, например:
                    POODLE (Padding Oracle On Downgraded Legacy Encryption) — атака на SSL 3.0, использующая уязвимость в обработке padding при расшифровке.
                    BEAST, CRIME, BREACH — атаки на TLS, эксплуатирующие особенности шифрования и сжатия.
                    Атаки по времени (Timing Attacks) — анализ времени расшифровки для извлечения ключей.
                Защита: Отключение устаревших протоколов (SSL 2.0/3.0). Использование современных шифров (AES-GCM, ChaCha20). Постоянное обновление криптографических библиотек (OpenSSL, BoringSSL).
            2. Атаки через сжатие данных (Compression Attacks)
                a) CRIME (Compression Ratio Info-leak Made Easy): Использует сжатие TLS/SPDY, чтобы определить содержимое зашифрованных cookie. Злоумышленник отправляет множество запросов с известными данными и анализирует размер сжатого трафика → выводит секрет (например, session cookie).
                b) BREACH (Browser Reconnaissance and Exfiltration via Adaptive Compression of Hypertext): Аналогична CRIME, но работает на уровне HTTP-сжатия (gzip/deflate), даже если TLS не использует сжатие. Эффективна против веб-приложений, отражающих введённые данные в ответ (например, поиск).
                Защита: Отключение сжатия в TLS. Для BREACH: добавление случайного "padding" в ответы, ограничение отражения пользовательских данных, CSRF-токены.
            3. Атаки на обработку форматов данных (Parsing Attacks)
                Уровень представления отвечает за преобразование данных в единый формат (например, JSON, XML, ASN.1, JPEG). Ошибки в парсинге могут привести к уязвимостям, например:
                    XML External Entity (XXE) — при обработке XML-данных парсер загружает внешние сущности → чтение файлов, SSRF.
                    Уязвимости в обработке изображений (например, через библиотеку libpng, libjpeg) — переполнение буфера при разборе повреждённого файла.
                    Атаки на ASN.1 (используется в сертификатах X.509, LDAP, SNMP), например переполнение при декодировании, когда передаются специально сформированные данные, которые вызывают сбой или выполнение кода при преобразовании.
                Защита: Валидация и санитизация входных данных. Использование безопасных парсеров (например, отключить внешние сущности в XML).Обновление библиотек обработки медиа и структурированных данных.
            4. Атаки на преобразование кодировок
                Эксплуатация различий в интерпретации кодировок (UTF-8, UTF-16, ISO-8859-1 и др.), например:
                    Обход фильтров через двойное кодирование (например, %253C → %3C → <).
                    Некорректная обработка Unicode → обход WAF или XSS-фильтров.
                    "Канонизация" путей — использование ..%c0%af вместо ../ для обхода проверок (в старых системах).
                Защита: Единая канонизация входных данных. Строгая проверка кодировок на всех этапах обработки. Использование современных фреймворков с встроенной защитой.

            Общие меры защиты:
                Использование проверенных библиотек для шифрования, сжатия и парсинга.
                Отключение ненужных функций (например, сжатие в TLS, внешние сущности в XML).
                Регулярное обновление ПО (особенно криптографических и медиа-библиотек).
                Тестирование на устойчивость к нестандартным/повреждённым данным (fuzzing).
            Важно:
                Уровень представления не имеет собственных сетевых пакетов — он работает внутри приложения. Поэтому атаки на него часто проявляются как уязвимости в прикладном ПО, но логически связаны с обработкой данных до их передачи или после получения. Многие из этих атак пересекаются с прикладным уровнем, но их корень — в некорректном представлении/преобразовании данных.

    Application Layer (Прикладной уровень)
        Назначение:
            Интерфейс между пользовательскими приложениями и сетью. Предоставляет сетевые службы напрямую конечному пользователю.
        Примеры реализации:
            протоколы HTTP, FTP, SMTP, DNS, Telnet.
        Примеры атак:
            Атаки на прикладном уровне — самые распространённые, так как они направлены на уязвимости в самих приложениях и сервисах, а не в сетевой инфраструктуре. Они часто не требуют глубоких сетевых знаний и могут быть автоматизированы.
        
        1. Внедрение кода (Code Injection)
            a) SQL-инъекция (SQLi): Злоумышленник вводит вредоносный SQL-код через поля ввода (формы, URL-параметры) для чтение, изменение или удаление данных в БД, обход аутентификации. Пример: ' OR '1'='1 в поле логина.
            Защита: параметризованные запросы (Prepared Statements), валидация ввода, WAF.
            b) OS-командная инъекция: Выполнение произвольных команд ОС через уязвимое приложение например, через функцию exec() в PHP.
            Защита: избегать вызова shell-команд с пользовательским вводом; использовать allowlist.
            с) LDAP/XPATH/NoSQL-инъекции: аналогичные атаки для других систем хранения данных.
        2. Межсайтовый скриптинг (XSS — Cross-Site Scripting)
            Внедрение вредоносного JavaScript-кода в веб-страницу, который выполняется в браузере жертвы для кражи cookie, перенаправления, фишинга, keyloggingа, например:
            Отражённая (Reflected) — через URL (например, фишинговая ссылка).
            Хранимая (Stored) — код сохраняется на сервере (например, в комментарии).
            DOM-based — уязвимость в клиентском JavaScript.
            Защита: Экранирование вывода (HTML-encoding). Использование CSP (Content Security Policy). Установка флагов HttpOnly и Secure для cookies.
        3. Подделка межсайтовых запросов (CSRF — Cross-Site Request Forgery)
            Злоумышленник заставляет браузер жертвы выполнить нежелательный запрос к уязвимому сайту, где пользователь уже авторизован. Например скрытая форма на вредоносном сайте отправляет запрос на изменение email в аккаунте жертвы.
            Защита: Использование anti-CSRF токенов. Проверка заголовка Origin/Referer. Требование повторного ввода пароля для критических действий.
        4. Атаки на аутентификацию и управление сессиями
            a) Brute-force / Credential stuffing: подбор паролей или использование утечённых учётных данных.
            b) Session hijacking: кража идентификатора сессии (часто через XSS или перехват трафика).
            c) Session fixation: принуждение пользователя к использованию известного session ID.
            Защита: Многофакторная аутентификация (MFA). Ограничение попыток входа. Генерация нового session ID после входа. Использование HTTPS.
        5. Атаки на DNS (Domain Name System)
            a) DNS Spoofing / Cache Poisoning: Подмена DNS-записей в кэше резолвера → перенаправление пользователей на фишинговый сайт.
            Защита: DNSSEC, обновление ПО DNS-серверов.
            b) DNS Amplification (DDoS): Использование открытых DNS-резолверов для амплификационной DDoS-атаки.
            Защита: закрытие рекурсивных резолверов от публичного доступа.
        6. Атаки на веб-приложения через уязвимости в логике
            a) Insecure Direct Object References (IDOR): Прямой доступ к ресурсам через изменение параметров (например, /user?id=123 → id=124).
            Защита: проверка прав доступа на каждом запросе.
            b) Открытые директории, debug-режим, утечка информации через заголовки. Пример: доступ к /admin без авторизации.
            c) SSRF (Server-Side Request Forgery): Принуждение сервера делать запросы во внутреннюю сеть (например, к http://169.254.169.254 в облаке) для получение метаданных, атака на внутренние сервисы.
            Защита: валидация URL, запрет приватных адресов.
        7. Фишинг и социальная инженерия
            Хотя это не техническая атака, фishing часто использует прикладные протоколы (HTTP, SMTP) для обмана пользователей, например письмо от "банка" с ссылкой на поддельный сайт (клон оригинала).
            Защита: обучение пользователей, DMARC/SPF/DKIM для email, браузерные предупреждения.
        8. Атаки на API (REST, GraphQL)
            Современные приложения активно используют API, которые также уязвимы: Отсутствие rate limiting → brute-force. Утечка данных через избыточные ответы. Неправильная авторизация (например, в GraphQL — инъекции запросов).
            Защита: аутентификация API-ключей, ограничение объёма данных, логирование.

        Общие меры защиты на прикладном уровне:
            Регулярное тестирование на проникновение (pentest) и сканирование уязвимостей.
            Использование WAF (Web Application Firewall).
            Принцип минимальных привилегий и проверка всех входных данных.
            Обновление зависимостей (библиотек, фреймворков).
            Безопасная разработка (Secure SDLC): код-ревью, статический анализ (SAST), динамическое тестирование (DAST).
        Важно:
            Прикладной уровень напрямую доступен из интернета.
            Часто содержит уникальный, плохо протестированный код.
            Ошибки здесь не зависят от сетевой инфраструктуры — даже защищённая сеть не спасёт от XSS или SQLi.
            Большинство утечек данных происходят именно из-за уязвимостей уровня 7.


 2. Сконвертировать IPv4 в IPv6 на сайте 3 разных ip адресов, прислать скрины до и после конвертации

    Прямого «конвертирования» IPv4-адреса в IPv6-адрес в смысле получения эквивалентного глобального IPv6-адреса не существует, потому что IPv4 и IPv6 — это разные протоколы с разными адресными пространствами. Однако в IPv6 существует специальный формат представления IPv4-адреса внутри IPv6, который используется в механизмах совместимости (например, IPv4-mapped IPv6 addresses или IPv4-embedded IPv6 addresses). Это нужно для того, чтобы IPv6-приложения могли взаимодействовать с IPv4-хостами.
    
    Наиболее распространённый способ: IPv4-mapped IPv6 address
    Этот формат используется в сокетах ОС (например, в Linux) для представления IPv4-адреса в IPv6-форме.

    Формат:
        ::ffff:a.b.c.d
    или в полной шестнадцатеричной записи:
        0000:0000:0000:0000:0000:ffff:aabb:ccdd
    где a.b.c.d — обычный IPv4-адрес.

    Пример:
        IPv4:  192.168.1.10
        IPv6:  ::ffff:192.168.1.10
        в hex: ::ffff:c0a8:010a


    Перевод IPv4 в hex для mapped-адреса\:
        Разбить IPv4 на 4 октета: 192.168.1.10 и перевести каждый в hex:
        192 → c0
        168 → a8
        1   → 01
        10  → 0a
        
        Собрать последние 32 бита: c0a8:010a
        Полный mapped-адрес: ::ffff:c0a8:010a
    
    
    1. IPv4 для VK.COM - 87.240.132.72
    в формате IPv6 - ::ffff:87.240.132.72
    или в hex IPv6 - ::ffff:57f0:8448



 3. Подключить 3-ий интерфейс в PfSense (внутрення сеть lan3), настроить по аналогии с уроком. Подключить в эту сеть Ubuntu.

    В ВМ PfSense созданы две внутрение сети - internal_lan1 и internal_lan2
    - сеть internal_lan1 назначена для ВМ Kali и Metasploitable,
    - сеть internal_lan2 назначена для ВМ Ubuntu_server и Windows_server 

 4. В cisco packet tracer собрать стэнд, согласно уроку.(прислать скрин, что пинг с одного vlan долетает до второго vlan, а в обратку нет)
 
 5. Дополнительно можете настроить, чтобы router был dhcp сервером и отдавал правильные пуллы айпи с правильным шлюзом


